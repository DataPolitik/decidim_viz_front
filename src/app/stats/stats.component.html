<div id="general_stats">
  <h2>
    {{'stats.demography' | translate}}
  </h2>
  <h3>
    {{'stats.general_data' | translate}}
  </h3>
  <section id="summary">
    <p *ngIf="!daily_user_loading; else still_loading">
      <fa-icon [icon]="this.faUsers"></fa-icon> {{this.daily_user_metrics?.count }} {{'stats.users_registered' | translate}}
    </p>
    <p *ngIf="!daily_proposal_loading; else still_loading">
      <fa-icon [icon]="this.faLightbulb"></fa-icon> {{this.daily_proposal_metrics?.count }} {{'stats.proposals_done' | translate}}
    </p>
    <p *ngIf="this.categories; else still_loading">
      <fa-icon [icon]="this.faDiagramProject"></fa-icon> {{this.categories.length }} {{'stats.categories' | translate}}
    </p>
    <p *ngIf="!participatory_processes_loading; else still_loading">
      <fa-icon [icon]="this.faUsersBetweenLines"></fa-icon> {{this.daily_participatory_processes_metrics?.count }} {{'stats.started_participative_processes' | translate}}
    </p>
    <p *ngIf="!daily_comment_loading && languages; else still_loading">
      <fa-icon [icon]="this.faLanguage"></fa-icon> {{this.comments_metrics?.count }} {{'stats.comments' | translate}} {{this.languages.length }} {{'stats.comments_language' | translate}}
    </p>
  </section>
</div>
<div>
  <h2>{{'stats.proposals' | translate}}</h2>
  <section>
    <h3>
      {{'stats.most_endorsed_proposals' | translate}} <fa-icon [icon]="this.faHandsClapping"></fa-icon>
    </h3>
    <div *ngIf="this.proposalsBySupports" class="demographic_table">
      <p-table [value]="this.proposalsBySupports">
        <ng-template pTemplate="header">
            <tr>
                <th>{{'stats.title' | translate}}</th>
                <th>{{'stats.endorsements' | translate}}</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-proposal>
            <tr>
                <td>{{proposal.title_es}}</td>
                <td>{{proposal.endorsements}}</td>
            </tr>
        </ng-template>
    </p-table>
    </div>

    <h3>
      {{'stats.most_commented_proposals' | translate}} <fa-icon [icon]="this.faComments"></fa-icon>
    </h3>
    <div *ngIf="this.proposalsByComments" class="demographic_table">
      <p-table [value]="this.proposalsByComments">
        <ng-template pTemplate="header">
            <tr>
                <th>{{'stats.title' | translate}}</th>
                <th>{{'stats.comments' | translate}}</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-proposal>
            <tr>
                <td>{{proposal.title_es}}</td>
                <td>{{proposal.comments}}</td>
            </tr>
        </ng-template>
      </p-table>
    </div>

    <h3>
      {{'stats.areas_with_more_proposals' | translate}} <fa-icon [icon]="this.faLayerGroup"></fa-icon>
    </h3>
    <div *ngIf="this.categoriesByProposals"  class="demographic_table">
      <p-table [value]="this.categoriesByProposals">
        <ng-template pTemplate="header">
            <tr>
                <th>{{'stats.title' | translate}}</th>
                <th>{{'stats.proposals' | translate}}</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-category>
            <tr>
                <td>{{category.name_es}}</td>
                <td>{{category.categories}}</td>
            </tr>
        </ng-template>
      </p-table>
    </div>
  </section>
</div>
<div>
  <h2>{{'stats.comments' | translate}}</h2>
  <h3>
    {{'stats.comments_written_language' | translate}} <fa-icon [icon]="this.faLanguage"></fa-icon>
  </h3>
  <div class="container" class="demographic_table">
    <ag-charts-angular *ngIf="this.languageCount.length > 0 && this.languageTreeMapOptions"
      class="treemap"
      style="position: absolute; top: 0; right: 0; bottom: 0; left: 0;"
      [options]="this.languageTreeMapOptions"
    ></ag-charts-angular>
  </div>
  <h3>
    {{'stats.most_commented_categories' | translate}} <fa-icon [icon]="this.faComments"></fa-icon>
  </h3>
  <div *ngIf="this.categoriesByComments; else still_loading" class="demographic_table">
    <p-table [value]="this.categoriesByComments">
      <ng-template pTemplate="header">
          <tr>
              <th>{{'stats.title' | translate}}</th>
              <th>{{'stats.comments' | translate}}</th>
          </tr>
      </ng-template>
      <ng-template pTemplate="body" let-category>
          <tr>
              <td>{{category.name_en}}</td>
              <td>{{category.comments}}</td>
          </tr>
      </ng-template>
    </p-table>
  </div>
</div>


<ng-template #still_loading>
  <app-still-loading></app-still-loading>
</ng-template>
